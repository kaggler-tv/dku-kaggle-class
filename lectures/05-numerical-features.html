
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>수치형변수 가공 데모 &#8212; 단국대 2020 캐글 뽀개기</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Scikit-learn" href="06-scikit-learn-intro.html" />
    <link rel="prev" title="5. 수치형변수" href="05-numerical-features-intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">단국대 2020 캐글 뽀개기</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../main.html">
   단국대 2020년 가을학기 캐글 뽀개기 강좌
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01-intro.html">
   1장. Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-setup.html">
   2장. Setup
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="03-pandas-intro.html">
   3장. Pandas
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas-eda.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="04-numpy-intro.html">
   4장. Numpy, 선형회귀, 로지스틱회귀
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy-lr.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="05-numerical-features-intro.html">
   5장. 수치형변수 가공
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="06-scikit-learn-intro.html">
   6장. Scikit-learn, 결정트리
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="06-scikit-learn.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06-decision-trees.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="07-rf-lgb-intro.html">
   7장. Random Forest, GBM
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf-lgb.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf.html">
     Random Forest 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-lightgbm.html">
     LightGBM 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="08-cv-stacking-intro.html">
   8장. Cross-Validation, Stacking
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="08-cv-stacking.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lr-cv.html">
     로지스틱 회귀 CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-rf-cv.html">
     Random Forest CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lightgbm-cv.html">
     LightGBM CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lr.html">
     로지스틱 회귀 스태킹 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lgb.html">
     LightGBM 스태킹 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="09-tuning-intro.html">
   9장. 모델 튜닝, Hyperopt, Optuna
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="09-tuning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-hyperopt.html">
     Hyperopt 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-optuna.html">
     Optuna 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="10-pipeline-make-intro.html">
   10장. Pipeline, Make
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="10-pipeline-make.html">
     이론
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="11-categorical-features-intro.html">
   11장. 범주형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="11-categorical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="12-nn-intro.html">
   12장. 신경망, Keras
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-keras.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-cv.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="13-text-features-intro.html">
   13장. 문자열변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="13-text-features.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13-lr-tfidf.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="14-embeddings-intro.html">
   14장. Embedding, RNN
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="14-embeddings.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-cnn-emb.html">
     CNN - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-emb.html">
     LSTM - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-glove.html">
     LSTM - GloVe 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-attention.html">
     Attention 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="15-transfer-learning-intro.html">
   15장. 선학습 임베딩, 전이학습
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="15-transfer-learning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15-bert.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-data-augmentation.html">
   16장. Data Augmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-cnn.html">
   17장. CNN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18-image-classification.html">
   18장. Image Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19-post-processing.html">
   19장. 후처리, 기타팁
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/05-numerical-features.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/SDSTony/dku-kaggle-class"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/SDSTony/dku-kaggle-class/issues/new?title=Issue%20on%20page%20%2Flectures/05-numerical-features.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/SDSTony/dku-kaggle-class/master?urlpath=tree/lectures/05-numerical-features.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import">
   라이브러리 import 및 설정
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   학습데이터 로드
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eda-exploratory-data-analysis">
   EDA (Exploratory Data Analysis)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   선형회귀 모델 학습
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rmse-rmlse">
     RMSE/RMLSE 손실함수 정의
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     변수 가공없이 선형회귀 모델 학습
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#log1p">
     멱함수 분포 변수
     <code class="docutils literal notranslate">
      <span class="pre">
       log1p
      </span>
     </code>
     변환
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     날짜/시간 변수 처리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     정규화/스케일링
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binning">
     Binning
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#polynomial-regression">
     2차 다항회귀 (Polynomial Regression)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   참고자료
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>수치형변수 가공 데모<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>수치형변수는 가장 기본적인 변수 형태 중 하나입니다. 아래 3개의 변수 형태는 일반적으로 자주 관측되는 변수들입니다.</p>
<ul class="simple">
<li><p>수치형변수: 정수/실수 (집 값)</p></li>
<li><p>범주형변수: 범주 (성별)</p></li>
<li><p>이진변수: 참/거짓 (암 여부)</p></li>
</ul>
<p>이번 장에서는 수치형변수를 가공하는 법에 대해 실습과 병행하며 알아보겠습니다.</p>
<div class="section" id="import">
<h2>라이브러리 import 및 설정<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span><span class="p">,</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">simplefilter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
<span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>학습데이터 로드<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>이번 실습에 사용할 데이터는 데이콘의 <a class="reference external" href="https://dacon.io/competitions/open/235536/data/">영화 관객수 예측 모델 개발</a> 페이지에서 다운로드하여 <code class="docutils literal notranslate"><span class="pre">../data/movies/</span></code> 폴더에 저장을 해둡니다. 해당 데이터는 영화의 장르, 개봉일, 상영시간 등의 데이터로 영화 총 관객수 (<code class="docutils literal notranslate"><span class="pre">box_off_num</span></code>)를 예측하는 데이터입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data/movies/&#39;</span><span class="p">)</span>
<span class="n">trn_file</span> <span class="o">=</span> <span class="n">data_dir</span> <span class="o">/</span> <span class="s1">&#39;movies_train.csv&#39;</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">trn_file</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(600, 11)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>distributor</th>
      <th>genre</th>
      <th>release_time</th>
      <th>time</th>
      <th>screening_rat</th>
      <th>director</th>
      <th>dir_prev_bfnum</th>
      <th>dir_prev_num</th>
      <th>num_staff</th>
      <th>num_actor</th>
      <th>box_off_num</th>
    </tr>
    <tr>
      <th>title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>개들의 전쟁</th>
      <td>롯데엔터테인먼트</td>
      <td>액션</td>
      <td>2012-11-22</td>
      <td>96</td>
      <td>청소년 관람불가</td>
      <td>조병옥</td>
      <td>NaN</td>
      <td>0</td>
      <td>91</td>
      <td>2</td>
      <td>23398</td>
    </tr>
    <tr>
      <th>내부자들</th>
      <td>(주)쇼박스</td>
      <td>느와르</td>
      <td>2015-11-19</td>
      <td>130</td>
      <td>청소년 관람불가</td>
      <td>우민호</td>
      <td>1161602.50</td>
      <td>2</td>
      <td>387</td>
      <td>3</td>
      <td>7072501</td>
    </tr>
    <tr>
      <th>은밀하게 위대하게</th>
      <td>(주)쇼박스</td>
      <td>액션</td>
      <td>2013-06-05</td>
      <td>123</td>
      <td>15세 관람가</td>
      <td>장철수</td>
      <td>220775.25</td>
      <td>4</td>
      <td>343</td>
      <td>4</td>
      <td>6959083</td>
    </tr>
    <tr>
      <th>나는 공무원이다</th>
      <td>(주)NEW</td>
      <td>코미디</td>
      <td>2012-07-12</td>
      <td>101</td>
      <td>전체 관람가</td>
      <td>구자홍</td>
      <td>23894.00</td>
      <td>2</td>
      <td>20</td>
      <td>6</td>
      <td>217866</td>
    </tr>
    <tr>
      <th>불량남녀</th>
      <td>쇼박스(주)미디어플렉스</td>
      <td>코미디</td>
      <td>2010-11-04</td>
      <td>108</td>
      <td>15세 관람가</td>
      <td>신근호</td>
      <td>1.00</td>
      <td>1</td>
      <td>251</td>
      <td>2</td>
      <td>483387</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>데이터를 확인해보면 총 <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">dir_prev_bfnum</span></code>, <code class="docutils literal notranslate"><span class="pre">dir_prev_num</span></code>, <code class="docutils literal notranslate"><span class="pre">num_staff</span></code>, <code class="docutils literal notranslate"><span class="pre">num_actor</span></code>, 그리고 <code class="docutils literal notranslate"><span class="pre">box_off_num</span></code>까지 총 6개의 수치형변수가 존재함을 알 수 있습니다. 또한 <code class="docutils literal notranslate"><span class="pre">release_time</span></code> 데이터도 변환 과정을 통해 수치형변수로 가공할 수 있습니다. 해당 과정 또한 이번 실습에서 살펴보겠습니다.</p>
</div>
<div class="section" id="eda-exploratory-data-analysis">
<h2>EDA (Exploratory Data Analysis)<a class="headerlink" href="#eda-exploratory-data-analysis" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 600 entries, 개들의 전쟁 to 베를린
Data columns (total 11 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   distributor     600 non-null    object 
 1   genre           600 non-null    object 
 2   release_time    600 non-null    object 
 3   time            600 non-null    int64  
 4   screening_rat   600 non-null    object 
 5   director        600 non-null    object 
 6   dir_prev_bfnum  270 non-null    float64
 7   dir_prev_num    600 non-null    int64  
 8   num_staff       600 non-null    int64  
 9   num_actor       600 non-null    int64  
 10  box_off_num     600 non-null    int64  
dtypes: float64(1), int64(5), object(5)
memory usage: 56.2+ KB
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">info()</span></code>함수를 통해 각 열의 데이터 타입과 결측값 존재 유무를 확인할 수 있습니다. 데이터 타입으로 <code class="docutils literal notranslate"><span class="pre">object</span></code>, <code class="docutils literal notranslate"><span class="pre">int64</span></code>, <code class="docutils literal notranslate"><span class="pre">float64</span></code>이 현재 데이터에 존재하며 <code class="docutils literal notranslate"><span class="pre">object</span></code>는 문자열 데이터를 뜻합니다. 수치형 변수중 유일하게 <code class="docutils literal notranslate"><span class="pre">dir_prev_bfnum</span></code>만 <code class="docutils literal notranslate"><span class="pre">float64</span></code>인 것을 확인할 수 있습니다. 해당 열에는 결측값이 330개의 결측값이 존재하는데, 결측값이 <code class="docutils literal notranslate"><span class="pre">float64</span></code>형태로 인식되기 때문에 전체 열의 데이터 타입 또한 <code class="docutils literal notranslate"><span class="pre">float64</span></code>인 것을 확인할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 600 entries, 개들의 전쟁 to 베를린
Data columns (total 11 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   distributor     600 non-null    object 
 1   genre           600 non-null    object 
 2   release_time    600 non-null    object 
 3   time            600 non-null    int64  
 4   screening_rat   600 non-null    object 
 5   director        600 non-null    object 
 6   dir_prev_bfnum  600 non-null    float64
 7   dir_prev_num    600 non-null    int64  
 8   num_staff       600 non-null    int64  
 9   num_actor       600 non-null    int64  
 10  box_off_num     600 non-null    int64  
dtypes: float64(1), int64(5), object(5)
memory usage: 56.2+ KB
</pre></div>
</div>
</div>
</div>
<p>결측값을 0으로 대체합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>dir_prev_bfnum</th>
      <th>dir_prev_num</th>
      <th>num_staff</th>
      <th>num_actor</th>
      <th>box_off_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>600.000000</td>
      <td>6.000000e+02</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>6.000000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>100.863333</td>
      <td>4.726993e+05</td>
      <td>0.876667</td>
      <td>151.118333</td>
      <td>3.706667</td>
      <td>7.081818e+05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>18.097528</td>
      <td>1.309474e+06</td>
      <td>1.183409</td>
      <td>165.654671</td>
      <td>2.446889</td>
      <td>1.828006e+06</td>
    </tr>
    <tr>
      <th>min</th>
      <td>45.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>89.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>17.000000</td>
      <td>2.000000</td>
      <td>1.297250e+03</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>100.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>82.500000</td>
      <td>3.000000</td>
      <td>1.259100e+04</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>114.000000</td>
      <td>3.761416e+05</td>
      <td>2.000000</td>
      <td>264.000000</td>
      <td>4.000000</td>
      <td>4.798868e+05</td>
    </tr>
    <tr>
      <th>max</th>
      <td>180.000000</td>
      <td>1.761531e+07</td>
      <td>5.000000</td>
      <td>869.000000</td>
      <td>25.000000</td>
      <td>1.426277e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>수치형변수의 분포로부터 모든 수치형변수가 0 또는 양수의 값을 가짐을 알 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_col</span> <span class="o">=</span> <span class="s1">&#39;box_off_num&#39;</span>
<span class="n">pred_col</span> <span class="o">=</span> <span class="s1">&#39;pred&#39;</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">target_col</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;time&#39;, &#39;dir_prev_bfnum&#39;, &#39;dir_prev_num&#39;, &#39;num_staff&#39;, &#39;num_actor&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">box_off_num</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb5b8be3550&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_19_1.png" src="../_images/05-numerical-features_19_1.png" />
</div>
</div>
<p>예측 대상이 되는 타겟 변수인 <code class="docutils literal notranslate"><span class="pre">box_off_num</span></code>의 히스토그램을 확인해보면 0근처에 값이 집중적으로 분포함을 알 수 있습니다. 그래프 우측 하단에 <code class="docutils literal notranslate"><span class="pre">1e7</span></code>라는 숫자가 있는데 이것은 10^7을 뜻하며 10,000,000을 뜻합니다. 즉 x축에 1천만을 곱한 것이 원래 값이며 히스토그램을 통해 대부분 2백만 이하의 관객수를 달성한 것을 확인할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="n">num_cols</span> <span class="o">+</span> <span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fb5c8f460d0&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_21_1.png" src="../_images/05-numerical-features_21_1.png" />
</div>
</div>
<p>수치형변수 중 <code class="docutils literal notranslate"><span class="pre">time</span></code>은 정규분포에 가깝고 나머지는 멱함수 (power-law)분포에 가깝습니다.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>3장에서는 왼쪽에 쏠린 분포를 지수분포라고 안내했습니다. 멱함수 분포와 지수분포는 가시적으로 왼쪽에 쏠린 분포라는 점에서 비슷해 보이지만 수식이 다르며 그에 따라 각 분포별 특성도 다릅니다.</p>
<p><a class="reference external" href="https://math.stackexchange.com/questions/164436/difference-between-power-law-distribution-and-exponential-decay">https://math.stackexchange.com/questions/164436/difference-between-power-law-distribution-and-exponential-decay</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
    #T_feb47e26_f64c_11ea_bab3_acde48001122row0_col0 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row0_col1 {
            background-color:  #d4d4e8;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row0_col2 {
            background-color:  #c0c9e2;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row0_col3 {
            background-color:  #4697c4;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row0_col4 {
            background-color:  #f0eaf4;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row0_col5 {
            background-color:  #a7bddb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row1_col0 {
            background-color:  #e2dfee;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row1_col1 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row1_col2 {
            background-color:  #a1bbda;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row1_col3 {
            background-color:  #b9c6e0;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row1_col4 {
            background-color:  #fbf3f9;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row1_col5 {
            background-color:  #dad9ea;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row2_col0 {
            background-color:  #d8d7e9;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row2_col1 {
            background-color:  #a8bedc;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row2_col2 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row2_col3 {
            background-color:  #9ab8d8;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row2_col4 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row2_col5 {
            background-color:  #e3e0ee;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row3_col0 {
            background-color:  #4e9ac6;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row3_col1 {
            background-color:  #b1c2de;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row3_col2 {
            background-color:  #8bb2d4;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row3_col3 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row3_col4 {
            background-color:  #f5eff6;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row3_col5 {
            background-color:  #79abd0;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row4_col0 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row4_col1 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row4_col2 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row4_col3 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row4_col4 {
            background-color:  #023858;
            color:  #f1f1f1;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row4_col5 {
            background-color:  #fff7fb;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row5_col0 {
            background-color:  #a8bedc;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row5_col1 {
            background-color:  #cccfe5;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row5_col2 {
            background-color:  #d1d2e6;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row5_col3 {
            background-color:  #71a8ce;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row5_col4 {
            background-color:  #f0eaf4;
            color:  #000000;
        }    #T_feb47e26_f64c_11ea_bab3_acde48001122row5_col5 {
            background-color:  #023858;
            color:  #f1f1f1;
        }</style><table id="T_feb47e26_f64c_11ea_bab3_acde48001122" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >time</th>        <th class="col_heading level0 col1" >dir_prev_bfnum</th>        <th class="col_heading level0 col2" >dir_prev_num</th>        <th class="col_heading level0 col3" >num_staff</th>        <th class="col_heading level0 col4" >num_actor</th>        <th class="col_heading level0 col5" >box_off_num</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_feb47e26_f64c_11ea_bab3_acde48001122level0_row0" class="row_heading level0 row0" >time</th>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row0_col0" class="data row0 col0" >1.000000</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row0_col1" class="data row0 col1" >0.266065</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row0_col2" class="data row0 col2" >0.306727</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row0_col3" class="data row0 col3" >0.623205</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row0_col4" class="data row0 col4" >0.114153</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row0_col5" class="data row0 col5" >0.441452</td>
            </tr>
            <tr>
                        <th id="T_feb47e26_f64c_11ea_bab3_acde48001122level0_row1" class="row_heading level0 row1" >dir_prev_bfnum</th>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row1_col0" class="data row1 col0" >0.266065</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row1_col1" class="data row1 col1" >1.000000</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row1_col2" class="data row1 col2" >0.396616</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row1_col3" class="data row1 col3" >0.369657</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row1_col4" class="data row1 col4" >0.042491</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row1_col5" class="data row1 col5" >0.293791</td>
            </tr>
            <tr>
                        <th id="T_feb47e26_f64c_11ea_bab3_acde48001122level0_row2" class="row_heading level0 row2" >dir_prev_num</th>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row2_col0" class="data row2 col0" >0.306727</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row2_col1" class="data row2 col1" >0.396616</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row2_col2" class="data row2 col2" >1.000000</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row2_col3" class="data row2 col3" >0.450706</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row2_col4" class="data row2 col4" >0.014006</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row2_col5" class="data row2 col5" >0.259674</td>
            </tr>
            <tr>
                        <th id="T_feb47e26_f64c_11ea_bab3_acde48001122level0_row3" class="row_heading level0 row3" >num_staff</th>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row3_col0" class="data row3 col0" >0.623205</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row3_col1" class="data row3 col1" >0.369657</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row3_col2" class="data row3 col2" >0.450706</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row3_col3" class="data row3 col3" >1.000000</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row3_col4" class="data row3 col4" >0.077871</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row3_col5" class="data row3 col5" >0.544265</td>
            </tr>
            <tr>
                        <th id="T_feb47e26_f64c_11ea_bab3_acde48001122level0_row4" class="row_heading level0 row4" >num_actor</th>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row4_col0" class="data row4 col0" >0.114153</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row4_col1" class="data row4 col1" >0.042491</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row4_col2" class="data row4 col2" >0.014006</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row4_col3" class="data row4 col3" >0.077871</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row4_col4" class="data row4 col4" >1.000000</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row4_col5" class="data row4 col5" >0.111179</td>
            </tr>
            <tr>
                        <th id="T_feb47e26_f64c_11ea_bab3_acde48001122level0_row5" class="row_heading level0 row5" >box_off_num</th>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row5_col0" class="data row5 col0" >0.441452</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row5_col1" class="data row5 col1" >0.293791</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row5_col2" class="data row5 col2" >0.259674</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row5_col3" class="data row5 col3" >0.544265</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row5_col4" class="data row5 col4" >0.111179</td>
                        <td id="T_feb47e26_f64c_11ea_bab3_acde48001122row5_col5" class="data row5 col5" >1.000000</td>
            </tr>
    </tbody></table></div></div>
</div>
</div>
<div class="section" id="id3">
<h2>선형회귀 모델 학습<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rmse-rmlse">
<h3>RMSE/RMLSE 손실함수 정의<a class="headerlink" href="#rmse-rmlse" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
<span class="n">rmlse</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>변수 가공없이 선형회귀 모델 학습<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1500066.43
</pre></div>
</div>
</div>
</div>
<p>LinearRegression 모델을 초기화 한 후 <code class="docutils literal notranslate"><span class="pre">fit()</span></code>함수를 통해 학습을 합니다. 그리고 <code class="docutils literal notranslate"><span class="pre">predict()</span></code>을 통해 예측한 예측값을 <code class="docutils literal notranslate"><span class="pre">df[pred_col]</span></code>열에 저장합니다. RMSE를 산출해보면 1,500,066이 나온것을 알 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">pred_col</span><span class="p">,</span> <span class="n">target_col</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fb5a8bafc90&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_30_1.png" src="../_images/05-numerical-features_30_1.png" />
</div>
</div>
<p>종속변수가 멱함수 분포를 지닐 때 선형회귀 모델을 학습하고 예측하면 예측값에 음수가 나올 수 있으며 수치가 낮은 값에 대한 예측에는 오차가 많이 발생합니다. 우측 상단에 있는 산점도를 통해 이를 확인할 수 있습니다. 이상적으로 예측된 경우 우상향하는 대각선을 중심으로 산점도가 형성되어야 합니다. 하지만 현재 그래프는 실제 <code class="docutils literal notranslate"><span class="pre">box_off_num</span></code>이 0주변의 값일 때 예측값은 2백만으로도 예측을 하는 경우가 이습니다.</p>
</div>
<div class="section" id="log1p">
<h3>멱함수 분포 변수 <code class="docutils literal notranslate"><span class="pre">log1p</span></code> 변환<a class="headerlink" href="#log1p" title="Permalink to this headline">¶</a></h3>
<p>앞서 확인한 2가지 문제를 해결하기 위해 로그변환을 사용할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">box_off_num</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb5c93aa390&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_34_1.png" src="../_images/05-numerical-features_34_1.png" />
</div>
</div>
<p>멱함수 분포의 수치형 변수는 <code class="docutils literal notranslate"><span class="pre">np.log1p()</span></code> 함수로 정규분포에 가깝게 변환할 수 있습니다. <code class="docutils literal notranslate"><span class="pre">np.log1p()</span></code>함수는 원본 값에 1을 더해서 로그변환을 해주는 함수입니다. 1을 더해주는 이유는 원본 값에 0이 있을 경우 로그 값이 음의 무한대의 값을 갖기 때문에 해당 경우를 처리해주기 위함입니다. 로그변환된 종속변수로 선형회귀 모델을 학습한 후 예측값을 산출하면, 해당 값은 로그변환이 적용된 상태이기 때문에 역변환을 통해 원본 스케일로 변환을 해주어야 합니다. 이 때 사용하는 함수는 <code class="docutils literal notranslate"><span class="pre">np.expm1()</span></code>입니다. 앞서 1을 더해준 후 로그변환을 했기 때문에 역변환 이후에 1을 빼주기 위해 <code class="docutils literal notranslate"><span class="pre">np.expm1()</span></code>을 사용합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	 17129211.69
RMLSE:	        2.12
</pre></div>
</div>
</div>
</div>
<p>로그변환한 종속변수로 모델을 학습하고 예측을 합니다. 그리고 예측값을 <code class="docutils literal notranslate"><span class="pre">np.expm1()</span></code>을 통해 역변환 한뒤 <code class="docutils literal notranslate"><span class="pre">df[pred_col]</span></code>에 저장합니다. RMSE와 RMSLE(Root Mean Squared Logarithmic Error)를 계산해보면 위와 같습니다. RMSE는 로그변환을 하지 않았을 때보다 10배 이상 나빠진 것을 확인할 수 있습니다. 로그변환을 하게 되면 적은 숫자들에 대해서는 잘 예측을 하지만 값이 큰 숫자에 대한 오차가 더 커져서 이러한 현상이 발생합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">pred_col</span><span class="p">,</span> <span class="n">target_col</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fb5e900c110&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_38_1.png" src="../_images/05-numerical-features_38_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;box_off_num&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05-numerical-features_39_0.png" src="../_images/05-numerical-features_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>dir_prev_bfnum</th>
      <th>dir_prev_num</th>
      <th>num_staff</th>
      <th>num_actor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>600.000000</td>
      <td>6.000000e+02</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>100.863333</td>
      <td>4.726993e+05</td>
      <td>0.876667</td>
      <td>151.118333</td>
      <td>3.706667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>18.097528</td>
      <td>1.309474e+06</td>
      <td>1.183409</td>
      <td>165.654671</td>
      <td>2.446889</td>
    </tr>
    <tr>
      <th>min</th>
      <td>45.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>89.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>17.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>100.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>82.500000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>114.000000</td>
      <td>3.761416e+05</td>
      <td>2.000000</td>
      <td>264.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>180.000000</td>
      <td>1.761531e+07</td>
      <td>5.000000</td>
      <td>869.000000</td>
      <td>25.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;dir_prev_bfnum&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_prev_num&#39;</span><span class="p">,</span> <span class="s1">&#39;num_staff&#39;</span><span class="p">,</span> <span class="s1">&#39;num_actor&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;dir_prev_bfnum&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_prev_num&#39;</span><span class="p">,</span> <span class="s1">&#39;num_staff&#39;</span><span class="p">,</span> <span class="s1">&#39;num_actor&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>dir_prev_bfnum</th>
      <th>dir_prev_num</th>
      <th>num_staff</th>
      <th>num_actor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
      <td>600.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>100.863333</td>
      <td>5.305796</td>
      <td>0.462197</td>
      <td>4.026352</td>
      <td>1.446130</td>
    </tr>
    <tr>
      <th>std</th>
      <td>18.097528</td>
      <td>6.254561</td>
      <td>0.555570</td>
      <td>1.789517</td>
      <td>0.446256</td>
    </tr>
    <tr>
      <th>min</th>
      <td>45.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>89.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.890372</td>
      <td>1.098612</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.424829</td>
      <td>1.386294</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>114.000000</td>
      <td>12.837611</td>
      <td>1.098612</td>
      <td>5.579730</td>
      <td>1.609438</td>
    </tr>
    <tr>
      <th>max</th>
      <td>180.000000</td>
      <td>16.684279</td>
      <td>1.791759</td>
      <td>6.768493</td>
      <td>3.258097</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>수치형 독립변수 중 멱변환 분포를 따르는 변수에도 <code class="docutils literal notranslate"><span class="pre">np.log1p()</span></code> 변환을 적용하였다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="n">num_cols</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fb5a914b6d0&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_43_1.png" src="../_images/05-numerical-features_43_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1883568.88
RMLSE:	        2.32
</pre></div>
</div>
</div>
</div>
<p>RMLSE는 조금 나빠졌지만 RMSE는 크게 개선이 되었다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;box_off_num&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05-numerical-features_46_0.png" src="../_images/05-numerical-features_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>distributor</th>
      <th>genre</th>
      <th>release_time</th>
      <th>time</th>
      <th>screening_rat</th>
      <th>director</th>
      <th>dir_prev_bfnum</th>
      <th>dir_prev_num</th>
      <th>num_staff</th>
      <th>num_actor</th>
      <th>box_off_num</th>
      <th>pred</th>
    </tr>
    <tr>
      <th>title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>개들의 전쟁</th>
      <td>롯데엔터테인먼트</td>
      <td>액션</td>
      <td>2012-11-22</td>
      <td>96</td>
      <td>청소년 관람불가</td>
      <td>조병옥</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.521789</td>
      <td>1.098612</td>
      <td>23398</td>
      <td>12093.438433</td>
    </tr>
    <tr>
      <th>내부자들</th>
      <td>(주)쇼박스</td>
      <td>느와르</td>
      <td>2015-11-19</td>
      <td>130</td>
      <td>청소년 관람불가</td>
      <td>우민호</td>
      <td>13.965312</td>
      <td>1.098612</td>
      <td>5.961005</td>
      <td>1.386294</td>
      <td>7072501</td>
      <td>963891.149247</td>
    </tr>
    <tr>
      <th>은밀하게 위대하게</th>
      <td>(주)쇼박스</td>
      <td>액션</td>
      <td>2013-06-05</td>
      <td>123</td>
      <td>15세 관람가</td>
      <td>장철수</td>
      <td>12.304905</td>
      <td>1.609438</td>
      <td>5.840642</td>
      <td>1.609438</td>
      <td>6959083</td>
      <td>521738.259465</td>
    </tr>
    <tr>
      <th>나는 공무원이다</th>
      <td>(주)NEW</td>
      <td>코미디</td>
      <td>2012-07-12</td>
      <td>101</td>
      <td>전체 관람가</td>
      <td>구자홍</td>
      <td>10.081425</td>
      <td>1.098612</td>
      <td>3.044522</td>
      <td>1.945910</td>
      <td>217866</td>
      <td>19533.298119</td>
    </tr>
    <tr>
      <th>불량남녀</th>
      <td>쇼박스(주)미디어플렉스</td>
      <td>코미디</td>
      <td>2010-11-04</td>
      <td>108</td>
      <td>15세 관람가</td>
      <td>신근호</td>
      <td>0.693147</td>
      <td>0.693147</td>
      <td>5.529429</td>
      <td>1.098612</td>
      <td>483387</td>
      <td>50007.266863</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id5">
<h3>날짜/시간 변수 처리<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_time&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count                     600
unique                    330
top       2015-08-13 00:00:00
freq                        6
first     2010-01-02 00:00:00
last      2015-12-31 00:00:00
Name: release_time, dtype: object
</pre></div>
</div>
</div>
</div>
<p>날짜/시간 변수를 처리하기 위해선 <code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code>함수로 문자열 값을 datetime 타입으로 변경해줘야 합니다. 그리고 나서 아래 코드와 같이 년/월을 추출할 수 있습니다. <code class="docutils literal notranslate"><span class="pre">describe()</span></code>함수로 분포를 확인해보면 가장 먼저 시작된 영화의 상영일은 2010년 1월 2일임을 알 수 있고 가장 최근에 상영된 영화는 2015년 12월 31일에 상영된 것을 알 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>distributor</th>
      <th>genre</th>
      <th>release_time</th>
      <th>time</th>
      <th>screening_rat</th>
      <th>director</th>
      <th>dir_prev_bfnum</th>
      <th>dir_prev_num</th>
      <th>num_staff</th>
      <th>num_actor</th>
      <th>box_off_num</th>
      <th>pred</th>
      <th>year</th>
      <th>month</th>
    </tr>
    <tr>
      <th>title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>개들의 전쟁</th>
      <td>롯데엔터테인먼트</td>
      <td>액션</td>
      <td>2012-11-22</td>
      <td>96</td>
      <td>청소년 관람불가</td>
      <td>조병옥</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.521789</td>
      <td>1.098612</td>
      <td>23398</td>
      <td>12093.438433</td>
      <td>2012</td>
      <td>11</td>
    </tr>
    <tr>
      <th>내부자들</th>
      <td>(주)쇼박스</td>
      <td>느와르</td>
      <td>2015-11-19</td>
      <td>130</td>
      <td>청소년 관람불가</td>
      <td>우민호</td>
      <td>13.965312</td>
      <td>1.098612</td>
      <td>5.961005</td>
      <td>1.386294</td>
      <td>7072501</td>
      <td>963891.149247</td>
      <td>2015</td>
      <td>11</td>
    </tr>
    <tr>
      <th>은밀하게 위대하게</th>
      <td>(주)쇼박스</td>
      <td>액션</td>
      <td>2013-06-05</td>
      <td>123</td>
      <td>15세 관람가</td>
      <td>장철수</td>
      <td>12.304905</td>
      <td>1.609438</td>
      <td>5.840642</td>
      <td>1.609438</td>
      <td>6959083</td>
      <td>521738.259465</td>
      <td>2013</td>
      <td>6</td>
    </tr>
    <tr>
      <th>나는 공무원이다</th>
      <td>(주)NEW</td>
      <td>코미디</td>
      <td>2012-07-12</td>
      <td>101</td>
      <td>전체 관람가</td>
      <td>구자홍</td>
      <td>10.081425</td>
      <td>1.098612</td>
      <td>3.044522</td>
      <td>1.945910</td>
      <td>217866</td>
      <td>19533.298119</td>
      <td>2012</td>
      <td>7</td>
    </tr>
    <tr>
      <th>불량남녀</th>
      <td>쇼박스(주)미디어플렉스</td>
      <td>코미디</td>
      <td>2010-11-04</td>
      <td>108</td>
      <td>15세 관람가</td>
      <td>신근호</td>
      <td>0.693147</td>
      <td>0.693147</td>
      <td>5.529429</td>
      <td>1.098612</td>
      <td>483387</td>
      <td>50007.266863</td>
      <td>2010</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">dt.year</span></code>는 년도를 추출해주며 <code class="docutils literal notranslate"><span class="pre">dt.month</span></code>는 월을 추출합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_cols</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;time&#39;, &#39;dir_prev_bfnum&#39;, &#39;dir_prev_num&#39;, &#39;num_staff&#39;, &#39;num_actor&#39;, &#39;year&#39;, &#39;month&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1893420.63
RMLSE:	        2.31
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>정규화/스케일링<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
<p>알고리즘에 따라 수치형변숭 스케일링/정규분포화를 적용할 수 있습니다. 해당 방법은 선형회귀/결정트리 류의 알고리즘에는 도움이 되지는 않습니다. 해당 알고리즘은 스케일이 무관하게 학습을 하지만 신경망 네트워크 모델인 경우 스케일링이 중요하게 작용합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1893420.63
RMLSE:	        2.31
</pre></div>
</div>
</div>
</div>
<p>정규분포화는 <code class="docutils literal notranslate"><span class="pre">StandardScaler()</span></code>를 통해 적용가능합니다. 정규화를 해도 rmse와 rmsle에 변화는 없는것을 확인할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>

<span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1893420.63
RMLSE:	        2.31
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MinMaxScaler()</span></code>는 최솟값과 최댓값을 각각 0과 1로 변환해줍니다. 마찬가지로 선형회귀모델인 경우 손실함수에 변화는 없습니다.</p>
</div>
<div class="section" id="binning">
<h3>Binning<a class="headerlink" href="#binning" title="Permalink to this headline">¶</a></h3>
<p>수치형변수에는 binning을 적용할 수 있습니다. binning을 통해 수치형변수를 범주형변수로 변환할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_bin&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">plot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x7fb5a93dfa90&gt;
</pre></div>
</div>
<img alt="../_images/05-numerical-features_64_1.png" src="../_images/05-numerical-features_64_1.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pd.qcut()</span></code>함수를 사용해 binning을 할 수 있습니다. 두번째 파라미터에 4를 입력함으로써 총 4개의 bin으로 그룹을 짓게 됩니다. 수치값을 정렬한 뒤 1/4지점에 있는 값끼리 묶어서 0, 1, 2, 3의 라벨을 부여합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_bin&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>time_bin</th>
    </tr>
    <tr>
      <th>title</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>개들의 전쟁</th>
      <td>96</td>
      <td>1</td>
    </tr>
    <tr>
      <th>내부자들</th>
      <td>130</td>
      <td>3</td>
    </tr>
    <tr>
      <th>은밀하게 위대하게</th>
      <td>123</td>
      <td>3</td>
    </tr>
    <tr>
      <th>나는 공무원이다</th>
      <td>101</td>
      <td>2</td>
    </tr>
    <tr>
      <th>불량남녀</th>
      <td>108</td>
      <td>2</td>
    </tr>
    <tr>
      <th>강철대오 : 구국의 철가방</th>
      <td>113</td>
      <td>2</td>
    </tr>
    <tr>
      <th>길위에서</th>
      <td>104</td>
      <td>2</td>
    </tr>
    <tr>
      <th>회사원</th>
      <td>96</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1789, 바스티유의 연인들</th>
      <td>129</td>
      <td>3</td>
    </tr>
    <tr>
      <th>청춘그루브</th>
      <td>94</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(600, 11)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1730191.35
RMLSE:	        2.25
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">[[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">num_cols</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;month&#39;</span><span class="p">]],</span> 
               <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
               <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">])],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(600, 22)
</pre></div>
</div>
</div>
</div>
<p>범주형 변수를 one hot encoding방식으로 변환해서 독립변수로 사용한 후 선형회귀 모델을 학습시켜 보겠습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  1693164.29
RMLSE:	        2.22
</pre></div>
</div>
</div>
</div>
<p>RMSE와 RMSLE가 감소한 것을 확인할 수 있습니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;box_off_num&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05-numerical-features_73_0.png" src="../_images/05-numerical-features_73_0.png" />
</div>
</div>
</div>
<div class="section" id="polynomial-regression">
<h3>2차 다항회귀 (Polynomial Regression)<a class="headerlink" href="#polynomial-regression" title="Permalink to this headline">¶</a></h3>
<p>다항회귀는 여러개의 독립변수가 존재할 때 독립변수끼리 조합을 실시해 추가 변수를 만들어 모델을 생성하는 방법입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">num_cols</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(600, 36)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing</span></code>모듈에서 <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code>함수를 통해 다항회귀 변환을 실시할 수 이습니다. 위 예시는 2차 다항회귀 변환을 실시하는 예시입니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]))</span>
<span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; RMSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMLSE:</span><span class="se">\t</span><span class="si">{</span><span class="n">rmlse</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">])</span><span class="si">:</span><span class="s1">12.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RMSE:	  2925429.89
RMLSE:	        2.00
</pre></div>
</div>
</div>
</div>
<p>변형된 데이터로 모델을 학습시키고 예측해보면 rmsle는 감소했지만 rmse는 증가한 것을 볼 수 있습니다. 이처럼 다항회귀는 오버피팅/과적합의 위험이 존재하기 때문에 선별적으로 사용해야 합니다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">target_col</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">pred_col</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;box_off_num&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05-numerical-features_81_0.png" src="../_images/05-numerical-features_81_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>참고자료<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.slideshare.net/HJvanVeen/feature-engineering-72376750">Feature Engineering by HJ van Veen</a></p>
<ul>
<li><p>약 100페이지 정도가 되는 슬라이드며 어떤 경우에 특정 feature engineering 방법을 사용하는지 자세히 설명돼있습니다.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/preprocessing.html">scikit-learn의 Preprocessing 페이지</a></p>
<ul>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler">StandardScaler</a></p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html#sklearn.preprocessing.MinMaxScaler">MinMaxScaler</a></p></li>
</ul>
</li>
<li><p>Pandas</p>
<ul>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html">to_datetime()</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.qcut.html">qcut()</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html">get_dummies()</a></p></li>
<li><p>이번 실습에 활용한 주요 함수들의 상세 설명페이지 입니다.</p></li>
</ul>
</li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="05-numerical-features-intro.html" title="previous page">5. 수치형변수</a>
    <a class='right-next' id="next-link" href="06-scikit-learn-intro.html" title="next page">6. Scikit-learn</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kaggler-TV<br/>
        
            &copy; Copyright 2020-2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>