
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>18. Image Classification &#8212; 단국대 2020 캐글 뽀개기</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "kaggler-tv/dku-kaggle-class");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="19. 후처리 및 기타 팁" href="19-post-processing.html" />
    <link rel="prev" title="17. CNN" href="17-cnn.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">단국대 2020 캐글 뽀개기</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../main.html">
   단국대 2020년 가을학기 캐글 뽀개기 강좌
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01-intro.html">
   1장. Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-setup.html">
   2장. Setup
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="03-pandas-intro.html">
   3장. Pandas
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas-eda.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="04-numpy-intro.html">
   4장. Numpy, 선형회귀, 로지스틱회귀
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy-lr.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="05-numerical-features-intro.html">
   5장. 수치형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="05-numerical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="06-scikit-learn-intro.html">
   6장. Scikit-learn, 결정트리
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="06-scikit-learn.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06-decision-trees.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="07-rf-lgb-intro.html">
   7장. Random Forest, GBM
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf-lgb.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf.html">
     Random Forest 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-lightgbm.html">
     LightGBM 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="08-cv-stacking-intro.html">
   8장. Cross-Validation, Stacking
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="08-cv-stacking.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lr-cv.html">
     로지스틱 회귀 CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-rf-cv.html">
     Random Forest CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lightgbm-cv.html">
     LightGBM CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lr.html">
     로지스틱 회귀 스태킹 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lgb.html">
     LightGBM 스태킹 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="09-tuning-intro.html">
   9장. 모델 튜닝, Hyperopt, Optuna
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="09-tuning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-hyperopt.html">
     Hyperopt 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-optuna.html">
     Optuna 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="10-pipeline-make-intro.html">
   10장. Pipeline, Make
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="10-pipeline-make.html">
     이론
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="11-categorical-features-intro.html">
   11장. 범주형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="11-categorical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="12-nn-intro.html">
   12장. 신경망, Keras
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-keras.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-cv.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="13-text-features-intro.html">
   13장. 문자열변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="13-text-features.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13-lr-tfidf.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="14-embeddings-intro.html">
   14장. Embedding, RNN
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="14-embeddings.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-cnn-emb.html">
     CNN - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-emb.html">
     LSTM - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-glove.html">
     LSTM - GloVe 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-attention.html">
     Attention 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="15-transfer-learning-intro.html">
   15장. 선학습 임베딩, 전이학습
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="15-transfer-learning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15-bert.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-data-augmentation.html">
   16장. Data Augmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-cnn.html">
   17장. CNN
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   18장. Image Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19-post-processing.html">
   19장. 후처리, 기타팁
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/18-image-classification.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kaggler-tv/dku-kaggle-class/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kaggler-tv/dku-kaggle-class//issues/new?title=Issue%20on%20page%20%2Flectures/18-image-classification.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eda-preprocessing">
   18.1 EDA / Preprocessing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-augmentation">
   18.2 Image Augmentation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-modeling">
   18.3 Image Modeling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metadata-modeling">
   18.4 Metadata Modeling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensembling">
   18.5 Ensembling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tips">
   18.6 Tips
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   18.7 참고자료
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="image-classification">
<h1>18. Image Classification<a class="headerlink" href="#image-classification" title="Permalink to this headline">¶</a></h1>
<p>18장에서는 이미지 분류 대회 접근법에 대해 살펴보겠습니다. 일반적으로 이미지 분류 대회를 접근할 때는 EDA/Preprocessing, Image Augmentation, Image Modeling, Metadata Modeling, Ensembling 순으로 진행합니다.</p>
<div class="section" id="eda-preprocessing">
<h2>18.1 EDA / Preprocessing<a class="headerlink" href="#eda-preprocessing" title="Permalink to this headline">¶</a></h2>
<p>이미지 데이터가 JPG/PNG로 처럼 RGB 이미지 포맷으로 저장돼있을 경우에는 <a class="reference external" href="https://opencv.org/">OpenCV</a>나 <a class="reference external" href="https://pillow.readthedocs.io/en/stable/handbook/tutorial.html#using-the-image-class">Pillow</a> 라이브러리를 사용해 불러와서 처리합니다.</p>
<p>X-ray, MRI 처럼 의료용 이미지일 경우 <a class="reference external" href="https://en.wikipedia.org/wiki/DICOM">DiCOM</a> 형태로 제공됩니다. DiCOM은 의료 이미지 데이터를 저장하는 표준 포멧입니다. DiCOM은 환자의 성별, 이미지 저장시 사용한 기기 등 metadata를 포함합니다. DiCOM을 불러올 때는 <a class="reference external" href="https://github.com/pydicom/pydicom">Pydicom</a> 라이브러리를 사용합니다.</p>
<p>OpenCV, Pillow, Pydicom을 사용해 불러온 이미지에 <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>에서 제공하는 <code class="docutils literal notranslate"><span class="pre">imshow</span></code>를 사용해서 시각화 할 수 있습니다. 이미지 시각화를 통해 이미지의 사이즈, 밝기, 색감등을 확인해서 추후 전처리가 필요한지 결정을 내립니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch18-img01.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 18-1 matplotlib을 사용한 의료 이미지 시각화 예시(<a class="reference external" href="https://docs.google.com/presentation/d/1dmCmkv0mWeuf-rHkrOYBXPKaPIwW4B6gSsVPzerOGLc/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>이미지 사아즈가 동일하지 않다면 resize를 통해 사이즈를 맞춰주고 밝기나 색감이 다르다면 gray scale로 통일하거나 normalization을 적용해주기도 합니다. 또한 이미지 내의 주요 부분만 추출하기 위해 cropping을 적용하기도 합니다. Cropping을 할 때는 중요 부분을 같이 잘라내지 않도록 주의가 필요합니다.</p>
</div>
<div class="section" id="image-augmentation">
<h2>18.2 Image Augmentation<a class="headerlink" href="#image-augmentation" title="Permalink to this headline">¶</a></h2>
<p>Image augmentation은 <a class="reference internal" href="16-data-augmentation.html"><span class="doc std std-doc">16장</span></a>에서 다뤄본 것 처럼 이미지를 회전하거나 뒤집거나 확대/축소 등을 사용해서 데이터의 양을 부풀리는 과정입니다. 또한 Mixup, Cutout, CutMix등의 방법도 존재하며 세부 사항은 <a class="reference internal" href="16-data-augmentation.html"><span class="doc std std-doc">16장</span></a>을 참고바랍니다.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Image augmentation을 cross validation과 함께 사용할 경우 augmented된 이미지는 원본 이미지와 같은 fold에 속해야 합니다. 모델 학습에 사용한 데이터가 검증 데이터셋에도 존재한다면 모델의 성능은 상대적으로 좋게 나올 것이므로 올바른 모델 검증이 진행되지 않습니다.</p>
</div>
</div>
<div class="section" id="image-modeling">
<h2>18.3 Image Modeling<a class="headerlink" href="#image-modeling" title="Permalink to this headline">¶</a></h2>
<p>이미지 데이터를 처리하는 모델을 구축할 때는 직접 CNN 구조를 디자인하거나 또는 <a class="reference internal" href="17-cnn.html"><span class="doc std std-doc">17장</span></a>에서 살펴본 pre-trained 모델 구조를 사용할 수도 있습니다. 데이터과학 대회에서는 이미 방대한 데이터셋에 대해 검증된 pre-trained 모델을 주로 사용합니다.</p>
<p>Pre-trained 모델을 사용하는 방법도 크게 3가지로 구분됩니다. 첫번째는 Pre-trained 모델을 있는 그대로 사용해서 직접 예측하는 방법입니다. 두번째는 pre-trained 모델의 변수를 고정 시킨 후 새 레이어를 추가 후 학습 및 예측을 하는 방법입니다. 세번째는 pre-trained 모델의 변수도 함께 학습 후 예측하는 방법입니다. 일반적으로 세번째 방법을 fine-tuning이라고 부르며 대회에서 최종 모델로 많이 사용하는 방법입니다.</p>
<p>Pre-trained 모델을 베이스라인 모델로 사용할 때 일반적으로 Inception-v3, ResNet-50, 그리고 EfficentNet-B0을 사용합니다. 베이스라인 모델은 대회 초기에 여러가지 실험을 적용해볼 수 있도록 기준이 되는 모델입니다. 베이스라인 모델에 다양한 이미지 augmentation 및 전처리를 적용해 어떤 augmentation과 전처리 방법이 성능을 높이는지 실험을 해볼 수 있습니다. 그렇게 해서 선정된 augmentation과 전처리 기법으로 데이터를 처리한 후 최종 모델로 EfficientNet-B3 또는 B3 이상을 사용해 성능을 더 올릴 수 있습니다.</p>
</div>
<div class="section" id="metadata-modeling">
<h2>18.4 Metadata Modeling<a class="headerlink" href="#metadata-modeling" title="Permalink to this headline">¶</a></h2>
<p>18.1절에서 언급한 것 처럼 의료용 데이터 포멧인 DiCOM 같은 경우 이미지에 대한 metadata가 함께 제공될 수 있습니다. 이러한 metadata를 이미지 데이터와 함께 사용 시 최종 예측 성능을 향상 시킬 수 있습니다. Metadata를 결합하는 방법은 두 가지가 있습니다. 첫번째는 metadata만을 가지고 lightgbm, xgboost등의 모델을 학습한 후 이미지 모델과 앙상블하는 방법입니다. 두번째는 CNN 모델을 구성해두고 sub-network로 metadata를 처리할 수 있는 신경망을 구축한 뒤 CNN 모델과 sub-network의 결과물을 합친 후 dense 레이어에 전달해서 최종 결과물을 산출하는 방법입니다.</p>
<p>2019년과 2020년에 열린 의료용 이미지 대회인 Melanoma Classification 대회의 1위 솔루션이 모두 metadata를 함께 사용한 방법이였습니다. 2019년도와 2020년도 모두 CNN 모델의 결과물과 sub-network에서 metadata를 처리해 나온 결과물을 합친 뒤 추가 레이어에 전달해서 최종 예측을 했습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch18-img02.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 18-2 <a class="reference external" href="https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/154683">Melanoma Classification 2019 1st Place</a> (<a class="reference external" href="https://docs.google.com/presentation/d/1dmCmkv0mWeuf-rHkrOYBXPKaPIwW4B6gSsVPzerOGLc/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch18-img03.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 18-3 <a class="reference external" href="https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/175412">Melanoma Classification 2020 1st Place</a> (<a class="reference external" href="https://docs.google.com/presentation/d/1dmCmkv0mWeuf-rHkrOYBXPKaPIwW4B6gSsVPzerOGLc/edit?usp=sharing">출처</a>)</p></li>
</ul>
</div>
<div class="section" id="ensembling">
<h2>18.5 Ensembling<a class="headerlink" href="#ensembling" title="Permalink to this headline">¶</a></h2>
<p>이미지 대회에서 앙상블을 적용할 때도 여러가지 방법이 존재합니다. 첫번째는 서로 다른 pre-trained CNN 모델을 앙상블 하는 방법입니다. ResNet, EfficientNet, Inception-v3 등의 모델을 학습 후 결과물을 앙상블하는 경우입니다. 두번째 방법은 동일한 CNN 모델에 입력 이미지 사이즈를 다르게 해서 여러개의 모델을 생성 후 앙상블하는 방법입니다. 마지막 방법은 GBDT 처럼 CNN과는 다른 종류의 알고리즘을 CNN과 함께 앙상블 하는 방법입니다.</p>
</div>
<div class="section" id="tips">
<h2>18.6 Tips<a class="headerlink" href="#tips" title="Permalink to this headline">¶</a></h2>
<p>이미지 데이터과학 대회 참여 시 도움 되는 팁들에 대해서 살펴보겠습니다.</p>
<ul class="simple">
<li><p>GPU/TPU는 가능하면 사용하는 것이 좋습니다. CNN 모델을 빠르게 학습할 수 있기 때문입니다.</p></li>
<li><p>Mixed precision을 사용해 모델 학습을 권장드립니다. Mixed precision은 모델 가중치의 소수점 자리수를 필요에 따라 16자리 또는 32자리로 사용하는 방법입니다. Mixed precision을 통해 모델 학습 시간을 줄일 수 있습니다.</p></li>
<li><p>Learning rate scheduler 사용을 권장드립니다. 모델 학습이 진행됨에 따라 learning rate를 다르게 가져가는 방법이며 실전에서 모델 성능 향상에 효과가 있다고 알려져 있습니다.</p></li>
<li><p>Test-time augmentation(TTA) 또한 모델 성능 향상에 도움되기 때문에 사용을 권장드립니다.</p></li>
</ul>
</div>
<div class="section" id="id1">
<h2>18.7 참고자료<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://keras.io/examples/vision/">Computer Vision Code Examples</a> (Keras)</p></li>
<li><p><a class="reference external" href="https://www.kaggle.com/c/tpu-getting-started">Petals to the Metal | Kaggle</a></p>
<ul>
<li><p><a class="reference external" href="https://www.kaggle.com/servietsky/pretrained-cnn-epic-fight">Pretrained CNN Epic Fight ⚔️ | Kaggle</a></p></li>
<li><p><a class="reference external" href="https://www.kaggle.com/cdeotte/rotation-augmentation-gpu-tpu-0-96">Rotation Augmentation GPU/TPU - [0.96+] | Kaggle</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/154683">Melanoma Classification 2019 1st Place </a></p></li>
<li><p><a class="reference external" href="https://www.kaggle.com/c/siim-isic-melanoma-classification/discussion/175412">Melanoma Classification 2020 1st Place</a></p></li>
<li><p><a class="reference external" href="https://www.upaper.net/jeongyoonlee/1136706">머신러닝 마스터 클래스</a> (PyTorch)</p>
<ul>
<li><p>10장. 이미지 모델링</p></li>
</ul>
</li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="17-cnn.html" title="previous page">17. CNN</a>
    <a class='right-next' id="next-link" href="19-post-processing.html" title="next page">19. 후처리 및 기타 팁</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kaggler-TV<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <div class="row_footer"> Website organized by <a href="https://github.com/SDSTony">Sungjin Ahn</a> </div>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-154415912-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>