
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Numpy &#8212; 단국대 2020 캐글 뽀개기</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "kaggler-tv/dku-kaggle-class");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="선형회귀 데모" href="04-numpy-lr.html" />
    <link rel="prev" title="4. Numpy" href="04-numpy-intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">단국대 2020 캐글 뽀개기</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../main.html">
   단국대 2020년 가을학기 캐글 뽀개기 강좌
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01-intro.html">
   1장. Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-setup.html">
   2장. Setup
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="03-pandas-intro.html">
   3장. Pandas
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03-pandas-eda.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="04-numpy-intro.html">
   4장. Numpy, 선형회귀, 로지스틱회귀
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04-numpy-lr.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="05-numerical-features-intro.html">
   5장. 수치형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="05-numerical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="06-scikit-learn-intro.html">
   6장. Scikit-learn, 결정트리
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="06-scikit-learn.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06-decision-trees.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="07-rf-lgb-intro.html">
   7장. Random Forest, GBM
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf-lgb.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-rf.html">
     Random Forest 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07-lightgbm.html">
     LightGBM 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="08-cv-stacking-intro.html">
   8장. Cross-Validation, Stacking
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="08-cv-stacking.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lr-cv.html">
     로지스틱 회귀 CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-rf-cv.html">
     Random Forest CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-lightgbm-cv.html">
     LightGBM CV 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lr.html">
     로지스틱 회귀 스태킹 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="08-stacking-lgb.html">
     LightGBM 스태킹 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="09-tuning-intro.html">
   9장. 모델 튜닝, Hyperopt, Optuna
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="09-tuning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-hyperopt.html">
     Hyperopt 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="09-lightgbm-optuna.html">
     Optuna 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="10-pipeline-make-intro.html">
   10장. Pipeline, Make
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="10-pipeline-make.html">
     이론
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="11-categorical-features-intro.html">
   11장. 범주형변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="11-categorical-features.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="12-nn-intro.html">
   12장. 신경망, Keras
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-keras.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12-nn-cv.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="13-text-features-intro.html">
   13장. 문자열변수 가공
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="13-text-features.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13-lr-tfidf.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="14-embeddings-intro.html">
   14장. Embedding, RNN
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="14-embeddings.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-cnn-emb.html">
     CNN - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-emb.html">
     LSTM - Embeddings 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-lstm-glove.html">
     LSTM - GloVe 실습
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="14-attention.html">
     Attention 실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="15-transfer-learning-intro.html">
   15장. 선학습 임베딩, 전이학습
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="15-transfer-learning.html">
     이론
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="15-bert.html">
     실습
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="16-data-augmentation.html">
   16장. Data Augmentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="17-cnn.html">
   17장. CNN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="18-image-classification.html">
   18장. Image Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19-post-processing.html">
   19장. 후처리, 기타팁
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/04-numpy.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kaggler-tv/dku-kaggle-class/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kaggler-tv/dku-kaggle-class//issues/new?title=Issue%20on%20page%20%2Flectures/04-numpy.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   4.1 Numpy 설치
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   4.2 Numpy 기초
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   4.3 Numpy 인덱싱/연산
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   4.4 Numpy 함수
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   4.5 선형회귀
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   4.6 로지스틱회귀
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   4.7 참고자료
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="numpy">
<h1>4. Numpy<a class="headerlink" href="#numpy" title="Permalink to this headline">¶</a></h1>
<p>3장에서는 파이썬의 대표 데이터 분석/처리 라이브러리라고 할 수 있는 Pandas에 대해 알아보았습니다. 4장에서는 파이썬의 대표 선형대수 라이브러리인 Numpy에 대해 알아보겠습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img01.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-1 Numpy 로고(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>Numpy는 연구하시는 분들 뿐만 아니라 현장에서 데이터 사이언스 하시는 분들과 더불어 수치해석 쪽을 하시는 분들도 주로 사용하는 라이브러리 입니다.</p>
<p>2005년에 Travis Oliphant가 서로 다른 장단점이 있던 Numeric 라이브러리와 Numarray 라이브러리를 결합해서 Numpy v1.0를 출시 했습니다. 그 때 부터 Numpy에서 고성능의 벡터/행렬 연산 및 바이너리 데이터 타입을 지원하기 시작했습니다. 2005년 전에는 수치해석이나 선형대수를 하기 위해 대부분 Matlab과 같은 유료 소프트웨어를 사용했었습니다. 하지만 Numpy와 Scipy 같은 라이브러리가 나오면서 최근들어 Matlab보다 파이썬을 활용하는 경우가 많아졌습니다.</p>
<div class="section" id="id1">
<h2>4.1 Numpy 설치<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Numpy 설치는 <a class="reference external" href="https://kaggler-tv.github.io/dku-kaggle-class/lectures/03-pandas.html#id1">3.1절</a>에 나온 Pandas 설치 방법과 유사합니다. Anaconda Navigator 사용자는 Environments 탭에 가서 Numpy를 설치하고자 하는 가상환경을 선택 후 Numpy를 체크하면 설치가 됩니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img02.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-2 Anaconda Navigator에서 Numpy 설치(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>터미널을 사용하는 분들은 <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">[가상환경</span> <span class="pre">이름]</span></code> 명령어를 통해 가상환경을 실행하고 <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span></code>명령어를 통해 numpy를 설치합니다. 이미 Numpy가 설치 되어 있을 경우 <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-U</span> <span class="pre">numpy</span></code>명령어를 통해 최신 버전으로 업그레이드 할 수 있습니다.</p>
</div>
<div class="section" id="id2">
<h2>4.2 Numpy 기초<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Numpy에서 가장 기본에 되는 데이터 타입은 ndarray 이며 줄여서 array라고도 합니다. nd는 N-dimensional의 약자이며 ndarray는 임의의 차원의 array를 뜻합니다. ndarray 데이터 타입 보유한 속성들은 아래와 같습니다.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>속성명</p></th>
<th class="head"><p>설명</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ndarray.ndim</p></td>
<td><p>차원 개수</p></td>
</tr>
<tr class="row-odd"><td><p>ndarray.shape</p></td>
<td><p>배열 크기</p></td>
</tr>
<tr class="row-even"><td><p>ndarray.size</p></td>
<td><p>배열의 원소 개수</p></td>
</tr>
<tr class="row-odd"><td><p>ndarray.dtype</p></td>
<td><p>배열의 데이터 타입</p></td>
</tr>
<tr class="row-even"><td><p>ndarray.itemsize</p></td>
<td><p>원소의 바이트 크기</p></td>
</tr>
<tr class="row-odd"><td><p>ndarray.data</p></td>
<td><p>배열의 데이터</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>표 4-1 ndarray 데이터 타입이 지원하는 속성</p></li>
</ul>
<p>각 속성에 대한 예제는 아래 그림 4-3에서 확인할 수 있습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img03.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-3 ndarray 속성 사용 예제(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
</div>
<div class="section" id="id3">
<h2>4.3 Numpy 인덱싱/연산<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>array는 인덱싱이 빠르며 벡터 또는 행렬 연산이 빠릅니다. 파이썬에서 제공하는 기본 데이터 타입인 리스트로 행렬을 만든다면 2행 3열의 원소를 접근하기 위해 <code class="docutils literal notranslate"><span class="pre">b[2][3]</span></code>처럼 대괄호를 총 4개를 사용해야 인덱싱이 가능합니다. 하지만 array에서는 <code class="docutils literal notranslate"><span class="pre">b[2,3]</span></code>처럼 간편하게 인덱싱이 가능합니다. 그림 4-4에서 array 인덱싱 예시를 확인할 수 있습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img04.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-4 array 인덱싱 예제(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>또한 array에서는 특정 범위를 지정해서 인덱싱이 가능합니다. <code class="docutils literal notranslate"><span class="pre">b[0:5,</span> <span class="pre">1]</span></code>명령어는 1번째 열에 있는 0부터 4번째 행의 원소를 반환합니다. <code class="docutils literal notranslate"><span class="pre">b[:,</span> <span class="pre">1]</span></code>명령어는 1번째 열에 있는 모든 행의 원소를 반환합니다.</p>
<p>또한 조건문을 통해서 인덱싱이 가능합니다. <code class="docutils literal notranslate"><span class="pre">a</span></code> 행렬 내에 존재하는 원소 중 4보다 큰 원소들만 보고 싶다면 먼저 <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">4</span></code> 조건문을 b에 저장한 후, 조건문이 반환한 True, False로 이뤄진 array로 a를 인덱싱할 수 있습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img05.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-5 array 인덱싱 예제(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>array간의 사칙연산도 지원 됩니다. 크기가 같은 두 개의 array간 사칙연산을 실시하면 element-wise한 연산이 실행 됩니다. 또한 제곱 연산이나 기타 연산도 element-wise하게 적용 됩니다. 아래 그림을 통해 element-wise한 연산의 예시를 확인할 수 있습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img06.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-6 element-wise 연산 예제(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>array간 <code class="docutils literal notranslate"><span class="pre">*</span></code> 연산을 진행하면 element-wise한 곱셉이 실행됩니다. 행렬 곱셉을 구하기 위해선 <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>을 사용하거나 <code class="docutils literal notranslate"><span class="pre">dot()</span></code>함수를 사용해야 합니다. 아래 예시를 통해 확인할 수 있습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img07.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-7 행렬곱 연산 예제(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
</div>
<div class="section" id="id4">
<h2>4.4 Numpy 함수<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>아래 예제를 통해 Numpy가 제공하는 주요 함수들을 살펴보도록 하겠습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img08.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-8 random(), sum(), min(), max() 예제(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>그림 4-8에서 가장 첫번째로 등장하는 <code class="docutils literal notranslate"><span class="pre">rg.random()</span></code>함수는 난수를 생성합니다. 이때 <code class="docutils literal notranslate"><span class="pre">rg</span></code>에는 <code class="docutils literal notranslate"><span class="pre">np.random.default_rng(1)</span></code>가 저장돼있습니다. 그 다음에 나오는 <code class="docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="docutils literal notranslate"><span class="pre">min()</span></code>, <code class="docutils literal notranslate"><span class="pre">max()</span></code>은 <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>에서 제공하는 member function이며 총합, 최솟값, 최댓값을 산출해줍니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img09.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-9 행/열 방향 연산(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>그림 4-9에서는 <code class="docutils literal notranslate"><span class="pre">sum()</span></code>과 <code class="docutils literal notranslate"><span class="pre">min()</span></code> 함수에 <code class="docutils literal notranslate"><span class="pre">axis</span></code>값을 주어 행 또는 열의 방향으로 연산을 하는 예시입니다. <code class="docutils literal notranslate"><span class="pre">sum(axis=0)</span></code>은 특정 열에 있는 모든 원소를 더해서 값을 반환하며 <code class="docutils literal notranslate"><span class="pre">min(axis=1)</span></code>는 특정 행에 있는 모든 원소 중 최솟값을 반환합니다. <code class="docutils literal notranslate"><span class="pre">cumsum(axis=1)</span></code>은 특정 행 방향으로 누적합을 구하는 명령어입니다.</p>
<p>이 외에도 numpy에서 제공하는 주요 함수들을 요약하면 아래와 같습니다.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>함수</p></th>
<th class="head"><p>Column B</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>exp, log, expm1, log1p</p></td>
<td><p>지수함수 또는 로그함수를 사용해 숫자 변환</p></td>
</tr>
<tr class="row-odd"><td><p>sqrt, square, abs</p></td>
<td><p>루트, 제곱, 절대값 산출</p></td>
</tr>
<tr class="row-even"><td><p>mean, median, var, std</p></td>
<td><p>평균, 중앙값, 분산, 표준편차 산출</p></td>
</tr>
<tr class="row-odd"><td><p>sin, cos</p></td>
<td><p>sin, cos값 산출</p></td>
</tr>
<tr class="row-even"><td><p>corrcoef</p></td>
<td><p>상관계수 산출</p></td>
</tr>
<tr class="row-odd"><td><p>concatenate, vstack, hstack</p></td>
<td><p>array 결합</p></td>
</tr>
<tr class="row-even"><td><p>reshape</p></td>
<td><p>array 크기 변경</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>표 4-2 numpy에서 제공하는 주요 함수</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Numpy 공식 문서인 <a class="reference external" href="https://numpy.org/doc/stable/user/quickstart.html">https://numpy.org/doc/stable/user/quickstart.html</a> 에서 더 많은 예제들을 확인해 볼 수 있습니다.</p>
</div>
</div>
<div class="section" id="id5">
<h2>4.5 선형회귀<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>선형회귀 모델은 여러 분야에서 가장 널리 쓰이는 모델 중 하나입니다. 선형회귀 모델은 종속변수와 독립변수 간의 관계를 선형 수식으로 표현합니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img10.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-10 선형회귀 산식(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img11.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-11 주택 가격 예측을 위한 데이터(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>그림 4-10에 있는 식이 선형 회귀 모델의 예시입니다. 그림 4-11은 cs229에 나온 예제인데, 주택 가격을 예측하기 위해 평수와 방의 개수 정보가 같이 주어졌습니다. 주택 가격을 예측 하는 선형 회귀 모델을 구축하기 위해선 주택 가격을 종속변수로 두고 평수와 방의 개수를 독립변수로 두어 선형회귀 모델을 구축합니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img12.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-12 손실함수 산식(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>해당 모델이 좋은 모델인지 아닌지 판별하기 위해서 손실함수를 사용합니다. 주택 가격 처럼 연속된 값을 예측하는 문제를 회귀문제라고 하는데 회귀문제에서 사용하는 대표적인 손실함수는 Mean Squared Error(평균제곱오차)입니다. MSE는 실제값과 예측값의 차이를 구한 뒤 제곱을 하고, 모든 오차의 제곱을 평균내어 구합니다. MSE가 작은 모델일 수록 성능이 좋은 모델이 되겠습니다.</p>
<p>선형회귀 모델 학습 시 목표는 손실함수가 최소가 되는 계수를 찾는 것입니다. 해당 계수를 찾기 위해 경사하강법을 사용하기도 하고 <a class="reference external" href="https://ko.wikipedia.org/wiki/%EC%A0%95%EA%B7%9C%EB%B0%A9%EC%A0%95%EC%8B%9D">정규방정식(normal equation)</a>을 사용하기도 합니다. 경사하강법은 선형회귀 모델 뿐만 아니라 이외의 알고리즘을 최적화 할 때도 사용하기 때문에 이번 장에서는 경사하강법에 대해 알아보겠습니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img13.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-13 경사하강법(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>경사하강법을 통해 파라미터를 업데이트하는 방법은 손실함수를 특정 파라미터로 미분한 값에 임의의 상수를 곱해서 기존의 파라미터에 빼줌으로써 새로운 계수를 구합니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img14.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-14 손실함수 미분 결과(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img15.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-15 선형회귀 모델의 경사하강법 산식(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>미분한 결과를 보면 모델 예측값에 실제값을 뺀 후 해당 피쳐를 곱해준 값과 같습니다. 그래서 각 샘플들을 입력할 때마다 경사하강법을 적용해서 지속적으로 계수를 업데이트 해줍니다. 이 때 알파값, 임의의 상수 값은 learning rate라고 하는데 해당 값이 너무 크면 업데이트가 되지 않기 때문에 일반적으로 작은 값을 사용합니다.</p>
</div>
<div class="section" id="id6">
<h2>4.6 로지스틱회귀<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>앞서 선형회귀 모델은 종속변수가 연속형, 실수 였지만 로지스틱회귀 모델은 종속변수가 범주형일 때 사용합니다. 로지스틱회귀 모델은 종속변수와 독립변수 간의 관계를 로지스틱 함수로 표현합니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img16.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-16 로지스틱 함수 시각화(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img17.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-17 로지스틱 함수(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>그림 4-16은 로지스틱 함수의 입력값에 따른 출력값을 시각화한 그림입니다. 입력값이 음의 무한대에서 양의 무한대 까지 가지더라도 출력되는 값은 항상 0에서 1의 사이의 값을 출력합니다. 그래서 선형회귀 모델의 출력값을 로지스틱 함수의 입력값으로 주면 선형회귀 모델의 출력값이 0과 1사이의 값으로 변환됩니다. 해당 과정을 통해 범주형 변수를 예측할 수 있습니다. 최종적으로 특정 한계값(threshold)를 기준으로 두어 한계값보다 작으면 0, 한계값보다 크면 1로 예측합니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img18.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-18 로지스틱 회귀 산식(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>로지스틱회귀에서는 log loss를 손실함수로 사용합니다. 개념적으로 확인해보면 실제값이 1인데 0으로 예측하면 패널티를 부가하고 실제값이 0인데 1로 예측해도 패널티를 부가하는 수식입니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img19.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-19 log loss 산식(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
<p>한 가지 재미있는점은 log loss를 손실함수로 설정한 후 경사하강법 산식을 유도해서 정리하면 선형회귀에서 사용한 경사하강법 산식과 똑같이 나옵니다.</p>
<p><img alt="" src="https://github.com/kaggler-tv/dku-kaggle-class/blob/master/course-website/imgs/ch04-img20.jpg?raw=true" /></p>
<ul class="simple">
<li><p>그림 4-20 로지스틱 회귀 모델의 경사하강법 산식(<a class="reference external" href="https://docs.google.com/presentation/d/1emLd1bVorVh9gfjJBd7ZNCbTxs3SZZOnaXx6aPwZNPQ/edit?usp=sharing">출처</a>)</p></li>
</ul>
</div>
<div class="section" id="id7">
<h2>4.7 참고자료<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/user/quickstart.html">NumPy 공식 홈페이지 문서</a></p>
<ul>
<li><p>Numpy의 공식 홈페이지를 참고하시면 numpy에서 제공하는 다양한 함수들에 대한 자세한 설명을 확인할 수 있습니다.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://woowabros.github.io/study/2018/08/01/linear_regression_qr.html">우아한형제들 기술 블로그 - Linear Regression</a></p>
<ul>
<li><p>우아한형제들 기술 블로그에서 Linear Regression을 배달 시간 예측과 연관지어 이해하기 쉽게 설명을 하니 본 강의와 더불어 참고하시면 좋겠습니다.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="http://cs229.stanford.edu/notes-spring2019/cs229-notes1.pdf">Stanford CS229 강의노트 #1</a></p>
<ul>
<li><p>선형회귀와 로지스틱회귀의 수식적인 내용을 더 깊게 공부해보고 싶은 분들에게 추천하는 Stanford 강의자료입니다.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.ime.unicamp.br/~dias/Intoduction%20to%20Statistical%20Learning.pdf">An Introduction to Statistical Learning (ISL)</a> 3장</p>
<ul>
<li><p>ISL은 머신러닝 알고리즘을 통계학적인 이론측면에서 자세히 설명하는 책입니다.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">Scikit-learn의 LinearRegression API 페이지</a></p>
<ul>
<li><p>Scikit-Learn의 LinearRegression 함수에 대해 자세한 설명이 기록돼있습니다.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html?highlight=logisticregression#sklearn.linear_model.LogisticRegression">Scikit-learn의 LogisticRegression API 페이지</a></p>
<ul>
<li><p>Scikit-Learn의 LogisticRegression 함수에 대해 자세한 설명이 기록돼있습니다.</p></li>
</ul>
</li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="04-numpy-intro.html" title="previous page">4. Numpy</a>
    <a class='right-next' id="next-link" href="04-numpy-lr.html" title="next page">선형회귀 데모</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kaggler-TV<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <div class="row_footer"> Website organized by <a href="https://github.com/SDSTony">Sungjin Ahn</a> </div>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-154415912-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>